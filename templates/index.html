<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Culinary AI Assistant</title>
    <link rel="stylesheet" href="/static/style.css">
</head>

<body>

<div class="container">
    <h1>ğŸ½ï¸ Culinary AI Assistant</h1>
    <p class="subtitle">
        Discover regional dishes, simple recipes, costs, and images using AI
    </p>

    <div class="input-box">
        <input
            type="text"
            id="location"
            placeholder="Enter a country or region (e.g., Italy)"
        >
        <button onclick="generate()">Generate</button>
    </div>

    <div id="loader" class="loader hidden"></div>

    <div id="output" class="output hidden">

        <div class="card">
            <h2>ğŸ¥˜ Classic Dishes</h2>
            <div id="meal"></div>
        </div>

        <div class="card">
            <h2>ğŸ‘¨â€ğŸ³ Easiest Recipe</h2>
            <div id="recipe"></div>
        </div>

        <div class="card highlight">
            <h2>â±ï¸ Time & Cost Estimate</h2>
            <div id="time"></div>
        </div>

        <div class="card">
            <h2>ğŸ“¸ Dish Images</h2>
            <div id="images" class="image-grid"></div>
        </div>

    </div>
</div>

<script>
function generate() {
    const locationInput = document.getElementById("location");
    const location = locationInput.value.trim();

    if (!location) {
        alert("Please enter a location");
        return;
    }

    const loader = document.getElementById("loader");
    const output = document.getElementById("output");
    const button = document.querySelector(".input-box button");
    const imagesDiv = document.getElementById("images");

    loader.classList.remove("hidden");
    output.classList.add("hidden");
    button.disabled = true;
    imagesDiv.innerHTML = "";

    fetch("/generate", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({ location })
    })
    .then(res => {
        if (!res.ok) {
            throw new Error("Server error");
        }
        return res.json();
    })
    .then(data => {
        document.getElementById("meal").innerHTML = data.meal;
        document.getElementById("recipe").innerHTML = data.recipe;
        document.getElementById("time").innerHTML = data.time;

        if (data.images && data.images.length > 0) {
            data.images.forEach(url => {
                const img = document.createElement("img");
                img.src = url;
                img.className = "dish-image";
                imagesDiv.appendChild(img);
            });
        } else {
            imagesDiv.innerHTML = "<p>No images found.</p>";
        }

        loader.classList.add("hidden");
        output.classList.remove("hidden");
        button.disabled = false;
    })
    .catch(err => {
        console.error(err);
        loader.classList.add("hidden");
        button.disabled = false;
        alert("Something went wrong. Please try again.");
    });
}
</script>

</body>
</html>
